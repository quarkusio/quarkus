name: Develocity - Terms of Service acceptance verification

on:
  # issue_comment event is triggered when a pull-request is commented
  issue_comment:
    types: [ created ]
  pull_request_target:

jobs:
  run-terms-of-service-acceptance:
    if: github.repository == 'quarkusio/quarkus'
    runs-on: ubuntu-latest
    permissions:
      # required to update signature file
      contents: write
      # required to comment pull-request
      pull-requests: write
      # required to update pull-request status check
      actions: write
      statuses: write
    steps:
      - name: Run Terms of Service acceptance verification
        uses: gradle/github-actions/terms-of-service-acceptance/run@v1-beta
        with:
          # tos-location can also point to a file in a Github repository with this syntax: /<owner>/<repo>/blob/<branch>/tos.html
          tos-location: 'https://foo.bar/tos.html'
          # Optional inputs
          pr-comment-tos-acceptance-missing: 'Quarkus uses Develocity to provide insights about CI builds. Please accept [Develocity Terms Of Service]({0}) to get your pull request Build Scan published by commenting this pull-request with the following message:'
          #pr-comment-tos-acceptance-request: 'I have read Develocity Terms Of Service and I hereby accept the Terms'
          pr-comment-tos-acceptance-validation: 'All contributors have accepted Develocity Terms Of Service.'
          # let's whitelist the most active contributors from Red Hat
          white-list: 'gsmet,geoand,stuartwdouglas,gastaldi,mkouba,cescoffier,sberyozkin,Sanne,aloubyansky,yrodiere,FroMage,phillip-kruger,machi1990,dmlloyd,iocanel,Sgitario,ia3andy,radcortez,rsvoboda,Ladicek,zakkak,ebullient,jmartisk,gwenneg,manovotn,maxandersen,starksm64,patriot1burke,emmanuelbernard,ozangunalp,michalvavrik,n1hility,tsegismont,galderz,ppalaga,evanchooly,holly-cummins,michelle-purcell,jponge,DavideD,karesti,brunobat,stalep,Karm,manusa,pedroigor,aureamunoz,metacosm,johnaohara,MichalMaler,MikeEdgar,alesj'
          white-list-only: true